table ip filter {
	chain INPUT {
		type filter hook input priority filter; policy drop;
		iifname != "lo" meta l4proto tcp ip saddr 10.10.10.10 tcp dport 53 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto udp ip saddr 10.10.10.10 udp dport 53 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 10.10.10.10 tcp sport 53 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto udp ip saddr 10.10.10.10 udp sport 53 counter packets 42597 bytes 6364331 accept
		iifname != "lo" counter packets 21760508 bytes 147520227931 jump LOCALINPUT
		iifname "lo" counter packets 3181544 bytes 1409987945 accept
		iifname != "lo" meta l4proto tcp counter packets 20061027 bytes 147401405865 jump INVALID
		iifname != "lo" meta l4proto tcp tcp dport 22 tcp flags & (fin|syn|rst|ack) == syn # #conn src/32 > 8 counter packets 5 bytes 300 jump CONNLIMIT
		iifname != "lo" meta l4proto icmp icmp type echo-request limit rate 1/second counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto icmp icmp type echo-request counter packets 0 bytes 0 jump LOGDROPIN
		iifname != "lo" meta l4proto icmp counter packets 43 bytes 3168 accept
		iifname != "lo" ct state related,established counter packets 19915895 bytes 147393306906 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 20 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 21 counter packets 2400 bytes 125392 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 22 counter packets 4648 bytes 272480 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 25 counter packets 275 bytes 15544 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 53 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 80 counter packets 5463 bytes 295845 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 110 counter packets 142 bytes 7700 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 143 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 443 counter packets 126885 bytes 7575724 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 465 counter packets 129 bytes 7304 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 587 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 993 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 995 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 2077 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 2078 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 2079 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 2080 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 2082 counter packets 140 bytes 7820 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 2083 counter packets 998 bytes 52952 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 2086 counter packets 95 bytes 5380 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 2087 counter packets 862 bytes 46004 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 2095 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 2096 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 2443 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 7770-7800 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 8443 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 44445 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 49152-65534 counter packets 4689 bytes 220684 accept
		iifname != "lo" meta l4proto udp ct state new udp dport 20 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto udp ct state new udp dport 21 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto udp ct state new udp dport 53 counter packets 0 bytes 0 accept
		iifname != "lo" counter packets 303 bytes 53875 jump LOGDROPIN
	}

	chain FORWARD {
		type filter hook forward priority filter; policy drop;
	}

	chain OUTPUT {
		type filter hook output priority filter; policy drop;
		oifname != "lo" meta l4proto tcp ip daddr 10.10.10.10 tcp dport 53 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp ip daddr 10.10.10.10 udp dport 53 counter packets 42598 bytes 3019853 accept
		oifname != "lo" meta l4proto tcp ip daddr 10.10.10.10 tcp sport 53 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp ip daddr 10.10.10.10 udp sport 53 counter packets 0 bytes 0 accept
		oifname != "lo" counter packets 14404904 bytes 38329912042 jump LOCALOUTPUT
		oifname != "lo" meta l4proto tcp tcp dport 53 counter packets 96 bytes 4224 accept
		oifname != "lo" meta l4proto udp udp dport 53 counter packets 2750 bytes 209707 accept
		oifname != "lo" meta l4proto tcp tcp sport 53 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp udp sport 53 counter packets 0 bytes 0 accept
		oifname "lo" counter packets 3181553 bytes 1409988305 accept
		oifname != "lo" meta l4proto tcp counter packets 4705784 bytes 20406827282 jump INVALID
		oifname != "lo" meta l4proto icmp counter packets 7 bytes 816 accept
		oifname != "lo" ct state related,established counter packets 4674912 bytes 20404964754 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 20 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 21 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 22 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 25 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 37 counter packets 1 bytes 60 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 43 counter packets 10 bytes 600 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 53 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 80 counter packets 1004 bytes 60240 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 110 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 113 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 443 counter packets 26397 bytes 1583820 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 465 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 587 counter packets 6 bytes 360 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 873 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 993 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 995 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 2086 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 2087 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 2089 counter packets 1 bytes 60 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 2703 counter packets 8 bytes 480 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 2443 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 7770-7800 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 8443 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 44445 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp ct state new udp dport 20 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp ct state new udp dport 21 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp ct state new udp dport 53 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp ct state new udp dport 113 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp ct state new udp dport 123 counter packets 684 bytes 51984 accept
		oifname != "lo" meta l4proto udp ct state new udp dport 873 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp ct state new udp dport 6277 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp ct state new udp dport 24441 counter packets 0 bytes 0 accept
		oifname != "lo" counter packets 8 bytes 320 jump LOGDROPOUT
	}

	chain CONNLIMIT {
		meta l4proto tcp counter packets 5 bytes 300 reject with tcp reset
	}

	chain LOGDROPIN {
		meta l4proto tcp tcp dport 23 counter packets 0 bytes 0 drop
		meta l4proto udp udp dport 23 counter packets 0 bytes 0 drop
		meta l4proto tcp tcp dport 67 counter packets 0 bytes 0 drop
		meta l4proto udp udp dport 67 counter packets 0 bytes 0 drop
		meta l4proto tcp tcp dport 68 counter packets 0 bytes 0 drop
		meta l4proto udp udp dport 68 counter packets 0 bytes 0 drop
		meta l4proto tcp tcp dport 111 counter packets 0 bytes 0 drop
		meta l4proto udp udp dport 111 counter packets 0 bytes 0 drop
		meta l4proto tcp tcp dport 113 counter packets 0 bytes 0 drop
		meta l4proto udp udp dport 113 counter packets 0 bytes 0 drop
		meta l4proto tcp tcp dport 135-139 counter packets 0 bytes 0 drop
		meta l4proto udp udp dport 135-139 counter packets 0 bytes 0 drop
		meta l4proto tcp tcp dport 445 counter packets 0 bytes 0 drop
		meta l4proto udp udp dport 445 counter packets 0 bytes 0 drop
		meta l4proto tcp tcp dport 500 counter packets 0 bytes 0 drop
		meta l4proto udp udp dport 500 counter packets 0 bytes 0 drop
		meta l4proto tcp tcp dport 513 counter packets 0 bytes 0 drop
		meta l4proto udp udp dport 513 counter packets 0 bytes 0 drop
		meta l4proto tcp tcp dport 520 counter packets 0 bytes 0 drop
		meta l4proto udp udp dport 520 counter packets 0 bytes 0 drop
		meta l4proto tcp limit rate 30/minute counter packets 118 bytes 5324 log prefix "Firewall: *TCP_IN Blocked* "
		meta l4proto udp limit rate 30/minute counter packets 185 bytes 48551 log prefix "Firewall: *UDP_IN Blocked* "
		meta l4proto icmp limit rate 30/minute counter packets 0 bytes 0 log prefix "Firewall: *ICMP_IN Blocked* "
		counter packets 303 bytes 53875 drop
	}

	chain LOGDROPOUT {
		meta l4proto tcp tcp flags & (fin|syn|rst|ack) == syn limit rate 30/minute counter packets 0 bytes 0 log prefix "Firewall: *TCP_OUT Blocked* " flags skuid
		meta l4proto udp limit rate 30/minute counter packets 0 bytes 0 log prefix "Firewall: *UDP_OUT Blocked* " flags skuid
		meta l4proto icmp limit rate 30/minute counter packets 0 bytes 0 log prefix "Firewall: *ICMP_OUT Blocked* " flags skuid
		counter packets 8 bytes 320 reject
	}

	chain DENYIN {
		# match-set chain_DENY src counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 199.45.155.103 tcp dport 25 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 199.45.155.103 tcp dport 465 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 199.45.155.103 tcp dport 587 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 206.168.34.203 tcp dport 25 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 206.168.34.203 tcp dport 465 counter packets 5 bytes 300 drop
		iifname != "lo" meta l4proto tcp ip saddr 206.168.34.203 tcp dport 587 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 167.94.146.60 tcp dport 25 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 167.94.146.60 tcp dport 465 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 167.94.146.60 tcp dport 587 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 199.45.155.105 tcp dport 25 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 199.45.155.105 tcp dport 465 counter packets 4 bytes 240 drop
		iifname != "lo" meta l4proto tcp ip saddr 199.45.155.105 tcp dport 587 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 167.94.146.50 tcp dport 25 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 167.94.146.50 tcp dport 465 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 167.94.146.50 tcp dport 587 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 199.45.154.157 tcp dport 25 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 199.45.154.157 tcp dport 465 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 199.45.154.157 tcp dport 587 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 199.45.155.102 tcp dport 25 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 199.45.155.102 tcp dport 465 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 199.45.155.102 tcp dport 587 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 206.168.34.33 tcp dport 25 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 206.168.34.33 tcp dport 465 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 206.168.34.33 tcp dport 587 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 206.168.34.84 tcp dport 25 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 206.168.34.84 tcp dport 465 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 206.168.34.84 tcp dport 587 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 162.142.125.116 tcp dport 25 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 162.142.125.116 tcp dport 465 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 162.142.125.116 tcp dport 587 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 206.168.34.74 tcp dport 25 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 206.168.34.74 tcp dport 465 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 206.168.34.74 tcp dport 587 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 206.168.34.214 tcp dport 25 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 206.168.34.214 tcp dport 465 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 206.168.34.214 tcp dport 587 counter packets 0 bytes 0 drop
		iifname != "lo" meta l4proto tcp ip saddr 152.32.209.49 tcp dport 22 counter packets 22 bytes 2028 drop
		iifname != "lo" meta l4proto tcp ip saddr 182.215.66.232 tcp dport 22 counter packets 29 bytes 3048 drop
	}

	chain DENYOUT {
		# match-set chain_DENY dst counter packets 0 bytes 0 jump LOGDROPOUT
	}

	chain ALLOWIN {
		iifname != "lo" ip saddr 209.59.180.118 counter packets 1387297 bytes 90346478 accept
		iifname != "lo" meta l4proto icmp ip saddr 10.50.9.0/24 icmp type echo-reply counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto icmp ip saddr 10.41.9.0/24 icmp type echo-reply counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto icmp ip saddr 10.40.11.0/28 icmp type echo-reply counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto icmp ip saddr 10.30.9.0/24 icmp type echo-reply counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto icmp ip saddr 10.20.9.0/24 icmp type echo-reply counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto icmp ip saddr 10.50.9.0/24 icmp type echo-request counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto icmp ip saddr 10.41.9.0/24 icmp type echo-request counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto icmp ip saddr 10.40.11.0/28 icmp type echo-request counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto icmp ip saddr 10.30.9.0/24 icmp type echo-request counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto icmp ip saddr 10.20.9.0/24 icmp type echo-request counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 10.50.9.0/24 tcp dport { 22,80,443,3306,9100,9104,9110,9115,9117,9253} counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 10.41.9.0/24 tcp dport { 22,80,443,3306,9100,9104,9110,9115,9117,9253} counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 10.40.11.0/28 tcp dport { 22,80,443,3306,9100,9104,9110,9115,9117,9253} counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 10.30.9.0/24 tcp dport { 22,80,443,3306,9100,9104,9110,9115,9117,9253} counter packets 145767 bytes 14033608 accept
		iifname != "lo" meta l4proto tcp ip saddr 10.20.9.0/24 tcp dport { 22,80,443,3306,9100,9104,9110,9115,9117,9253} counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 50.28.100.8 tcp sport { 80,443} counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 50.28.100.7 tcp sport { 80,443} counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 50.28.0.125 tcp sport { 80,443} counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 50.28.0.124 tcp sport { 80,443} counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 67.225.149.254 tcp sport { 80,443} counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 67.225.149.253 tcp sport { 80,443} counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 69.167.130.7 tcp sport { 80,443} counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 69.167.130.6 tcp sport { 80,443} counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 34.254.37.129 tcp dport 8443 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 34.254.37.129 tcp dport 443 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 34.254.37.129 tcp dport 80 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 52.213.169.7 tcp dport 8443 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 52.213.169.7 tcp dport 443 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 52.213.169.7 tcp dport 80 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 52.51.23.204 tcp dport 8443 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 52.51.23.204 tcp dport 443 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 52.51.23.204 tcp dport 80 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.86 tcp dport 1022 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.86 tcp dport 1021 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.86 tcp dport 1020 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.86 tcp dport 40 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.86 tcp dport 16 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.86 tcp dport 14 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.86 tcp dport 10 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.86 tcp dport 8 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.86 tcp dport 4 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.85 tcp dport 1022 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.85 tcp dport 1021 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.85 tcp dport 1020 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.85 tcp dport 40 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.85 tcp dport 16 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.85 tcp dport 14 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.85 tcp dport 10 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.85 tcp dport 8 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.85 tcp dport 4 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.83 tcp dport 1022 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.83 tcp dport 1021 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.83 tcp dport 1020 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.83 tcp dport 40 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.83 tcp dport 16 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.83 tcp dport 14 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.83 tcp dport 10 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.83 tcp dport 8 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.83 tcp dport 4 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.82 tcp dport 1022 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.82 tcp dport 1021 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.82 tcp dport 1020 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.82 tcp dport 40 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.82 tcp dport 16 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.82 tcp dport 14 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.82 tcp dport 10 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.82 tcp dport 8 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.121.82 tcp dport 4 counter packets 19 bytes 16910 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.123.3 tcp dport 1022 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.123.3 tcp dport 1021 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.123.3 tcp dport 1020 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.123.3 tcp dport 40 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.123.3 tcp dport 16 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.123.3 tcp dport 14 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.123.3 tcp dport 10 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.123.3 tcp dport 8 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.123.3 tcp dport 4 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.123.2 tcp dport 1022 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.123.2 tcp dport 1021 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.123.2 tcp dport 1020 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.123.2 tcp dport 40 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.123.2 tcp dport 16 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.123.2 tcp dport 14 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.123.2 tcp dport 10 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.123.2 tcp dport 8 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 208.74.123.2 tcp dport 4 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 199.66.201.132 tcp dport 53 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 199.66.201.132 tcp dport 443 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 199.66.201.132 tcp dport 80 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 91.199.212.132 tcp dport 53 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 91.199.212.132 tcp dport 443 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 91.199.212.132 tcp dport 80 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 91.199.212.52 tcp dport 53 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 91.199.212.52 tcp dport 443 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 91.199.212.52 tcp dport 80 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 178.255.81.13 tcp dport 53 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 178.255.81.13 tcp dport 443 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 178.255.81.13 tcp dport 80 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 178.255.81.12 tcp dport 53 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 178.255.81.12 tcp dport 443 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 178.255.81.12 tcp dport 80 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 10.50.9.0/24 tcp dport 2082 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 10.41.9.0/24 tcp dport 2082 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 10.40.11.0/28 tcp dport 2082 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 10.30.9.0/24 tcp dport 2082 counter packets 39797 bytes 2923755 accept
		iifname != "lo" meta l4proto tcp ip saddr 10.20.9.0/24 tcp dport 2082 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 162.244.6.230 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 162.244.6.228/31 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 162.244.6.224/30 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 162.244.6.208/28 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 162.244.6.204/30 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 162.244.6.202/31 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 162.244.6.201 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 185.151.160.55 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 185.151.160.54 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 185.151.160.25 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 185.151.160.24 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 185.151.161.12 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 185.151.161.11 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 162.244.7.15 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip saddr 162.244.7.14 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		# match-set chain_ALLOW src counter packets 121545 bytes 10449879 accept
	}

	chain ALLOWOUT {
		oifname != "lo" ip daddr 209.59.180.118 counter packets 1663130 bytes 17262886395 accept
		oifname != "lo" meta l4proto udp ip daddr 50.28.16.118 udp dport 123 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp ip daddr 69.16.234.101 udp dport 123 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp ip daddr 67.227.205.253 udp dport 123 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp ip daddr 69.167.129.136 udp dport 123 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp ip daddr 64.91.251.155 udp dport 123 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 104.17.52.20 tcp dport 443 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 104.17.51.20 tcp dport 443 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 104.17.55.10 tcp dport 443 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 104.17.54.10 tcp dport 443 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 104.207.228.90 tcp dport 9094 counter packets 7854 bytes 1267463 accept
		oifname != "lo" meta l4proto tcp ip daddr 104.207.228.89 tcp dport 9094 counter packets 8310 bytes 1230584 accept
		oifname != "lo" meta l4proto tcp ip daddr 104.207.228.88 tcp dport 9094 counter packets 9124 bytes 1252145 accept
		oifname != "lo" meta l4proto tcp ip daddr 104.207.228.87 tcp dport 9094 counter packets 8673 bytes 1284085 accept
		oifname != "lo" meta l4proto udp ip daddr 8.8.4.4 udp dport 53 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp ip daddr 8.8.8.8 udp dport 53 counter packets 2 bytes 162 accept
		oifname != "lo" meta l4proto udp ip daddr 1.1.1.3 udp dport 53 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp ip daddr 1.1.1.2 udp dport 53 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp ip daddr 1.1.1.1 udp dport 53 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp ip daddr 10.10.10.10 udp dport 53 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp ip daddr 69.167.128.254 udp dport 53 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp ip daddr 209.59.157.254 udp dport 53 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 8.8.4.4 tcp dport 53 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 8.8.8.8 tcp dport 53 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 1.1.1.3 tcp dport 53 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 1.1.1.2 tcp dport 53 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 1.1.1.1 tcp dport 53 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 10.10.10.10 tcp dport 53 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 69.167.128.254 tcp dport 53 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 209.59.157.254 tcp dport 53 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 195.214.233.82 tcp dport { 5224,443} counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 195.214.233.81 tcp dport { 5224,443} counter packets 13 bytes 8964 accept
		oifname != "lo" meta l4proto tcp ip daddr 195.214.233.80 tcp dport { 5224,443} counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 10.255.64.57 tcp dport { 443,80} counter packets 63 bytes 8953 accept
		oifname != "lo" meta l4proto tcp ip daddr 50.28.99.122 tcp dport 44445 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 50.28.99.120/31 tcp dport 44445 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 50.28.13.0/24 tcp dport 44445 counter packets 7724800 bytes 537862718 accept
		oifname != "lo" meta l4proto tcp ip daddr 162.244.6.0/24 tcp dport 44445 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 62.138.210.156 tcp dport 44445 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 62.138.210.154 tcp dport 44445 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 62.138.210.152/31 tcp dport 44445 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 62.138.210.148/30 tcp dport 44445 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 62.138.210.147 tcp dport 44445 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 62.138.210.144/31 tcp dport 44445 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 62.138.210.142/31 tcp dport 44445 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 62.138.210.141 tcp dport 44445 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 185.151.160.0/25 tcp dport 44445 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 162.244.7.25 tcp dport 443 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 162.244.7.20/30 tcp dport 443 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 162.244.7.17 tcp dport 443 counter packets 17846 bytes 1734081 accept
		oifname != "lo" meta l4proto tcp ip daddr 162.244.7.16 tcp dport 443 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 162.244.7.15 tcp dport { 443,8443,7770-7800} counter packets 21927 bytes 26950565 accept
		oifname != "lo" meta l4proto tcp ip daddr 162.244.7.14 tcp dport { 443,8443,7770-7800} counter packets 17453 bytes 23127103 accept
		oifname != "lo" meta l4proto tcp ip daddr 45.11.128.62 tcp dport 443 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip daddr 45.11.128.61 tcp dport 443 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip saddr 162.244.6.230 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip saddr 162.244.6.228/31 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip saddr 162.244.6.224/30 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip saddr 162.244.6.208/28 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip saddr 162.244.6.204/30 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip saddr 162.244.6.202/31 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip saddr 162.244.6.201 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip saddr 185.151.160.55 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip saddr 185.151.160.54 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip saddr 185.151.160.25 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip saddr 185.151.160.24 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip saddr 185.151.161.12 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip saddr 185.151.161.11 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip saddr 162.244.7.15 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ip saddr 162.244.7.14 tcp dport { 443,8443,7770-7800,44445} counter packets 0 bytes 0 accept
		# match-set chain_ALLOW dst counter packets 216392 bytes 65228408 accept
	}

	chain LOCALINPUT {
		iifname != "lo" counter packets 21760508 bytes 147520227931 jump ALLOWIN
		iifname != "lo" counter packets 20066083 bytes 147402457301 jump DENYIN
	}

	chain LOCALOUTPUT {
		oifname != "lo" counter packets 14404904 bytes 38329912042 jump ALLOWOUT
		oifname != "lo" counter packets 4709317 bytes 20407070416 jump DENYOUT
	}

	chain INVDROP {
		counter packets 5158 bytes 570347 drop
	}

	chain INVALID {
		ct state invalid counter packets 4621 bytes 533967 jump INVDROP
		meta l4proto tcp tcp flags & (fin|syn|rst|psh|ack|urg) == 0x0 counter packets 0 bytes 0 jump INVDROP
		meta l4proto tcp tcp flags & (fin|syn|rst|psh|ack|urg) == fin|syn|rst|psh|ack|urg counter packets 0 bytes 0 jump INVDROP
		meta l4proto tcp tcp flags & (fin|syn) == fin|syn counter packets 0 bytes 0 jump INVDROP
		meta l4proto tcp tcp flags & (syn|rst) == syn|rst counter packets 0 bytes 0 jump INVDROP
		meta l4proto tcp tcp flags & (fin|rst) == fin|rst counter packets 0 bytes 0 jump INVDROP
		meta l4proto tcp tcp flags & (fin|ack) == fin counter packets 0 bytes 0 jump INVDROP
		meta l4proto tcp tcp flags & (psh|ack) == psh counter packets 0 bytes 0 jump INVDROP
		meta l4proto tcp tcp flags & (ack|urg) == urg counter packets 0 bytes 0 jump INVDROP
		meta l4proto tcp tcp flags & (fin|syn|rst|ack) != syn ct state new counter packets 537 bytes 36380 jump INVDROP
	}
}
table ip raw {
	chain PREROUTING {
		type filter hook prerouting priority raw; policy accept;
	}

	chain OUTPUT {
		type filter hook output priority raw; policy accept;
	}
}
table ip mangle {
	chain PREROUTING {
		type filter hook prerouting priority mangle; policy accept;
	}

	chain INPUT {
		type filter hook input priority mangle; policy accept;
	}

	chain FORWARD {
		type filter hook forward priority mangle; policy accept;
	}

	chain OUTPUT {
		type route hook output priority mangle; policy accept;
	}

	chain POSTROUTING {
		type filter hook postrouting priority mangle; policy accept;
	}
}
table ip6 nat {
	chain PREROUTING {
		type nat hook prerouting priority dstnat; policy accept;
	}

	chain INPUT {
		type nat hook input priority 100; policy accept;
	}

	chain POSTROUTING {
		type nat hook postrouting priority srcnat; policy accept;
	}

	chain OUTPUT {
		type nat hook output priority -100; policy accept;
	}
}
table ip nat {
	chain PREROUTING {
		type nat hook prerouting priority dstnat; policy accept;
	}

	chain INPUT {
		type nat hook input priority 100; policy accept;
	}

	chain POSTROUTING {
		type nat hook postrouting priority srcnat; policy accept;
	}

	chain OUTPUT {
		type nat hook output priority -100; policy accept;
	}
}
table ip6 raw {
	chain PREROUTING {
		type filter hook prerouting priority raw; policy accept;
	}

	chain OUTPUT {
		type filter hook output priority raw; policy accept;
	}
}
table ip6 filter {
	chain INPUT {
		type filter hook input priority filter; policy drop;
		iifname != "lo" counter packets 3 bytes 216 jump LOCALINPUT
		iifname "lo" counter packets 31520 bytes 61803742 accept
		iifname != "lo" meta l4proto tcp counter packets 0 bytes 0 jump INVALID
		iifname != "lo" meta l4proto tcp tcp dport 22 tcp flags & (fin|syn|rst|ack) == syn # #conn src/128 > 8 counter packets 0 bytes 0 jump CONNLIMIT
		iifname != "lo" meta l4proto ipv6-icmp counter packets 3 bytes 216 accept
		iifname != "lo" ct state related,established counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 20 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 21 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 22 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 25 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 53 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 80 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 110 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 143 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 443 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 465 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 587 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 993 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 995 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 2077 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 2078 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 2082 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 2083 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 2086 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 2087 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 2095 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ct state new tcp dport 2096 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto udp ct state new udp dport 20 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto udp ct state new udp dport 21 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto udp ct state new udp dport 53 counter packets 0 bytes 0 accept
		iifname != "lo" counter packets 0 bytes 0 jump LOGDROPIN
	}

	chain FORWARD {
		type filter hook forward priority filter; policy drop;
	}

	chain OUTPUT {
		type filter hook output priority filter; policy drop;
		oifname != "lo" counter packets 34 bytes 1904 jump LOCALOUTPUT
		oifname != "lo" meta l4proto tcp tcp dport 53 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp udp dport 53 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp tcp sport 53 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp udp sport 53 counter packets 0 bytes 0 accept
		oifname "lo" counter packets 31520 bytes 61803742 accept
		oifname != "lo" meta l4proto tcp counter packets 0 bytes 0 jump INVALID
		oifname != "lo" meta l4proto ipv6-icmp counter packets 34 bytes 1904 accept
		oifname != "lo" ct state related,established counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 20 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 21 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 22 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 25 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 37 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 43 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 53 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 80 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 110 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 113 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 443 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 587 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 873 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 993 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 995 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 2086 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 2087 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 2089 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto tcp ct state new tcp dport 2703 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp ct state new udp dport 20 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp ct state new udp dport 21 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp ct state new udp dport 53 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp ct state new udp dport 113 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp ct state new udp dport 123 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp ct state new udp dport 873 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp ct state new udp dport 6277 counter packets 0 bytes 0 accept
		oifname != "lo" meta l4proto udp ct state new udp dport 24441 counter packets 0 bytes 0 accept
		oifname != "lo" counter packets 0 bytes 0 jump LOGDROPOUT
	}

	chain CONNLIMIT {
		meta l4proto tcp counter packets 0 bytes 0 reject with tcp reset
	}

	chain LOGDROPIN {
		meta l4proto tcp tcp dport 23 counter packets 0 bytes 0 drop
		meta l4proto udp udp dport 23 counter packets 0 bytes 0 drop
		meta l4proto tcp tcp dport 67 counter packets 0 bytes 0 drop
		meta l4proto udp udp dport 67 counter packets 0 bytes 0 drop
		meta l4proto tcp tcp dport 68 counter packets 0 bytes 0 drop
		meta l4proto udp udp dport 68 counter packets 0 bytes 0 drop
		meta l4proto tcp tcp dport 111 counter packets 0 bytes 0 drop
		meta l4proto udp udp dport 111 counter packets 0 bytes 0 drop
		meta l4proto tcp tcp dport 113 counter packets 0 bytes 0 drop
		meta l4proto udp udp dport 113 counter packets 0 bytes 0 drop
		meta l4proto tcp tcp dport 135-139 counter packets 0 bytes 0 drop
		meta l4proto udp udp dport 135-139 counter packets 0 bytes 0 drop
		meta l4proto tcp tcp dport 445 counter packets 0 bytes 0 drop
		meta l4proto udp udp dport 445 counter packets 0 bytes 0 drop
		meta l4proto tcp tcp dport 500 counter packets 0 bytes 0 drop
		meta l4proto udp udp dport 500 counter packets 0 bytes 0 drop
		meta l4proto tcp tcp dport 513 counter packets 0 bytes 0 drop
		meta l4proto udp udp dport 513 counter packets 0 bytes 0 drop
		meta l4proto tcp tcp dport 520 counter packets 0 bytes 0 drop
		meta l4proto udp udp dport 520 counter packets 0 bytes 0 drop
		meta l4proto tcp limit rate 30/minute counter packets 0 bytes 0 log prefix "Firewall: *TCP6IN Blocked* "
		meta l4proto udp limit rate 30/minute counter packets 0 bytes 0 log prefix "Firewall: *UDP6IN Blocked* "
		meta l4proto ipv6-icmp limit rate 30/minute counter packets 0 bytes 0 log prefix "Firewall: *ICMP6IN Blocked* "
		counter packets 0 bytes 0 drop
	}

	chain LOGDROPOUT {
		meta l4proto tcp tcp flags & (fin|syn|rst|ack) == syn limit rate 30/minute counter packets 0 bytes 0 log prefix "Firewall: *TCP6OUT Blocked* " flags skuid
		meta l4proto udp limit rate 30/minute counter packets 0 bytes 0 log prefix "Firewall: *UDP6OUT Blocked* " flags skuid
		meta l4proto ipv6-icmp limit rate 30/minute counter packets 0 bytes 0 log prefix "Firewall: *ICMP6OUT Blocked* " flags skuid
		counter packets 0 bytes 0 reject
	}

	chain DENYIN {
		# match-set chain_6_DENY src counter packets 0 bytes 0 drop
	}

	chain DENYOUT {
		# match-set chain_6_DENY dst counter packets 0 bytes 0 jump LOGDROPOUT
	}

	chain ALLOWIN {
		iifname != "lo" meta l4proto tcp ip6 saddr 2a02:1788:400:1ce4::/64 tcp dport 53 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip6 saddr 2a02:1788:400:1ce4::/64 tcp dport 443 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip6 saddr 2a02:1788:400:1ce4::/64 tcp dport 80 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip6 saddr 2a02:1788:402:1c80::/64 tcp dport 53 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip6 saddr 2a02:1788:402:1c80::/64 tcp dport 443 counter packets 0 bytes 0 accept
		iifname != "lo" meta l4proto tcp ip6 saddr 2a02:1788:402:1c80::/64 tcp dport 80 counter packets 0 bytes 0 accept
		# match-set chain_6_ALLOW src counter packets 0 bytes 0 accept
	}

	chain ALLOWOUT {
		# match-set chain_6_ALLOW dst counter packets 0 bytes 0 accept
	}

	chain LOCALINPUT {
		iifname != "lo" counter packets 3 bytes 216 jump ALLOWIN
		iifname != "lo" counter packets 3 bytes 216 jump DENYIN
	}

	chain LOCALOUTPUT {
		oifname != "lo" counter packets 34 bytes 1904 jump ALLOWOUT
		oifname != "lo" counter packets 34 bytes 1904 jump DENYOUT
	}

	chain INVDROP {
		counter packets 0 bytes 0 drop
	}

	chain INVALID {
		ct state invalid counter packets 0 bytes 0 jump INVDROP
		meta l4proto tcp tcp flags & (fin|syn|rst|psh|ack|urg) == 0x0 counter packets 0 bytes 0 jump INVDROP
		meta l4proto tcp tcp flags & (fin|syn|rst|psh|ack|urg) == fin|syn|rst|psh|ack|urg counter packets 0 bytes 0 jump INVDROP
		meta l4proto tcp tcp flags & (fin|syn) == fin|syn counter packets 0 bytes 0 jump INVDROP
		meta l4proto tcp tcp flags & (syn|rst) == syn|rst counter packets 0 bytes 0 jump INVDROP
		meta l4proto tcp tcp flags & (fin|rst) == fin|rst counter packets 0 bytes 0 jump INVDROP
		meta l4proto tcp tcp flags & (fin|ack) == fin counter packets 0 bytes 0 jump INVDROP
		meta l4proto tcp tcp flags & (psh|ack) == psh counter packets 0 bytes 0 jump INVDROP
		meta l4proto tcp tcp flags & (ack|urg) == urg counter packets 0 bytes 0 jump INVDROP
		meta l4proto tcp tcp flags & (fin|syn|rst|ack) != syn ct state new counter packets 0 bytes 0 jump INVDROP
	}
}
table ip6 mangle {
	chain PREROUTING {
		type filter hook prerouting priority mangle; policy accept;
	}

	chain INPUT {
		type filter hook input priority mangle; policy accept;
	}

	chain FORWARD {
		type filter hook forward priority mangle; policy accept;
	}

	chain OUTPUT {
		type route hook output priority mangle; policy accept;
	}

	chain POSTROUTING {
		type filter hook postrouting priority mangle; policy accept;
	}
}
table inet filter {
	chain INPUT {
		type filter hook input priority filter; policy accept;
		counter packets 1 bytes 52 jump cPanel-HostAccessControl
		counter packets 1 bytes 52 jump cP-Firewall-1-INPUT
	}

	chain FORWARD {
		type filter hook forward priority filter; policy accept;
		counter packets 0 bytes 0 jump cPanel-HostAccessControl
		counter packets 0 bytes 0 jump cP-Firewall-1-INPUT
	}

	chain OUTPUT {
		type filter hook output priority filter; policy accept;
	}

	chain cPanel-HostAccessControl {
	}

	chain cP-Firewall-1-INPUT {
		ct state new tcp dport 21 counter packets 0 bytes 0 accept
		ct state new tcp dport 22 counter packets 0 bytes 0 accept
		ct state new tcp dport 25 counter packets 0 bytes 0 accept
		ct state new tcp dport 26 counter packets 0 bytes 0 accept
		ct state new tcp dport 53 counter packets 0 bytes 0 accept
		ct state new tcp dport 80 counter packets 0 bytes 0 accept
		ct state new tcp dport 110 counter packets 0 bytes 0 accept
		ct state new tcp dport 143 counter packets 0 bytes 0 accept
		ct state new tcp dport 443 counter packets 0 bytes 0 accept
		ct state new tcp dport 465 counter packets 0 bytes 0 accept
		ct state new tcp dport 579 counter packets 0 bytes 0 accept
		ct state new tcp dport 587 counter packets 0 bytes 0 accept
		ct state new tcp dport 993 counter packets 0 bytes 0 accept
		ct state new tcp dport 995 counter packets 0 bytes 0 accept
		ct state new tcp dport 2077 counter packets 0 bytes 0 accept
		ct state new tcp dport 2078 counter packets 0 bytes 0 accept
		ct state new tcp dport 2079 counter packets 0 bytes 0 accept
		ct state new tcp dport 2080 counter packets 0 bytes 0 accept
		ct state new tcp dport 2082 counter packets 0 bytes 0 accept
		ct state new tcp dport 2083 counter packets 0 bytes 0 accept
		ct state new tcp dport 2086 counter packets 0 bytes 0 accept
		ct state new tcp dport 2087 counter packets 0 bytes 0 accept
		ct state new tcp dport 2091 counter packets 0 bytes 0 accept
		ct state new tcp dport 2095 counter packets 0 bytes 0 accept
		ct state new tcp dport 2096 counter packets 0 bytes 0 accept
		ct state new tcp dport 3306 counter packets 0 bytes 0 accept
		ct state new tcp dport 8080 counter packets 0 bytes 0 accept
		ct state new tcp dport 8443 counter packets 0 bytes 0 accept
		ct state new tcp dport 49152-65534 counter packets 0 bytes 0 accept
		ct state new udp dport 53 counter packets 0 bytes 0 accept
	}
}